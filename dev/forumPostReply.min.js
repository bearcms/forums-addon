/*
 * Forums addon for Bear CMS
 * https://github.com/bearcms/forums-addon
 * Copyright (c) Amplilabs Ltd.
 * Free to use under the MIT license.
 */
var bearCMS=bearCMS||{};
bearCMS.forumPostReply=bearCMS.forumPostReply||function(){var e=[],g=function(a){var b="ur"+a;"undefined"===typeof e[b]&&(e[b]=1,b=document.getElementById(a),clientShortcuts.get("users").then(function(b){b.currentUser.addEventListener("change",function(){f(a,null)})}),b.addEventListener("beforesubmit",k),b.addEventListener("submitsuccess",l))},f=function(a,b){var c=function(b){var c=document.getElementById(a),d=c.querySelector("textarea");b?(d.removeAttribute("readonly"),d.style.cursor="auto",d.removeEventListener("click",
h),c.querySelector(".bearcms-forum-post-page-send-button").style.removeProperty("display")):(d.setAttribute("readonly",!0),d.style.cursor="pointer",d.addEventListener("click",h),c.querySelector(".bearcms-forum-post-page-send-button").style.display="none")};null!==b?c(b):clientShortcuts.get("users").then(function(a){c(a.currentUser.exists())})},h=function(a){var b=a.target.parentNode.parentNode.id;clientShortcuts.get("users").then(function(a){g(b);a.openLogin()})},m=function(a){clientShortcuts.get("-bearcms-forums-html5domdocument").then(function(b){var c=
document.getElementById(a.listElementID);b.insert(a.listContent,[c,"outerHTML"])})},k=function(a){a=a.target;var b=a.previousSibling;a.querySelector('[name="fprcontext"]').value=JSON.stringify({listElementID:b.id})},l=function(a){var b=a.target;a=a.result;"undefined"!==typeof a.success&&(b.querySelector('[name="fprtext"]').value="",m(a))};return{initializeForm:function(a,b){f(a,b);if(b)return g(a)}}}();