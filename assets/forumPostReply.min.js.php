<?php

/*
 * Forums addon for Bear CMS
 * https://github.com/bearcms/forums-addon
 * Copyright (c) Amplilabs Ltd.
 * Free to use under the MIT license.
 */

return <<<'EOT'
var bearCMS=bearCMS||{};
bearCMS.forumPostReply=bearCMS.forumPostReply||function(){var g=[],k=function(a){var b="ur"+a;"undefined"===typeof g[b]&&(g[b]=1,b=document.getElementById(a),clientPackages.get("users").then(function(c){c.currentUser.addEventListener("change",function(){h(a,null)})}),b.addEventListener("beforesubmit",m),b.addEventListener("submitsuccess",n))},h=function(a,b){var c=function(f){var e=document.getElementById(a),d=e.querySelector("textarea");f?(d.removeAttribute("readonly"),d.style.cursor="auto",d.removeEventListener("click",
l),e.querySelector('[data-form-element-type="submit-button"]').style.removeProperty("display")):(d.setAttribute("readonly",!0),d.style.cursor="pointer",d.addEventListener("click",l),e.querySelector('[data-form-element-type="submit-button"]').style.display="none")};null!==b?c(b):clientPackages.get("users").then(function(f){f.currentUser.exists().then(function(e){c(e)})})},l=function(a){var b=a.target.closest("form").id;clientPackages.get("users").then(function(c){k(b);c.openLogin()})},p=function(a){clientPackages.get("html5DOMDocument").then(function(b){var c=
document.getElementById(a.listElementID);b.insert(a.listContent,[c,"outerHTML"])})},m=function(a){a=a.target;var b=a.previousSibling;a.querySelector('[name="fprcontext"]').value=JSON.stringify({listElementID:b.id})},n=function(a){var b=a.target;a=a.result;"undefined"!==typeof a.success&&(b.querySelector('[name="fprtext"]').value="",p(a))};return{initializeForm:function(a,b){h(a,b);if(b)return k(a)}}}();
EOT;
