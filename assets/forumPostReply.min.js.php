<?php

/*
 * Forums addon for Bear CMS
 * https://github.com/bearcms/forums-addon
 * Copyright (c) Amplilabs Ltd.
 * Free to use under the MIT license.
 */

 return <<<'EOT'
 var bearCMS=bearCMS||{};bearCMS.forumPostReply=bearCMS.forumPostReply||function(){var e=[],t=function(t){var r="ur"+t;if(void 0===e[r]){e[r]=1;var u=document.getElementById(t);clientPackages.get("users").then((function(e){e.currentUser.addEventListener("change",(function(){n(t,null)}))})),u.addEventListener("beforesubmit",i),u.addEventListener("submitsuccess",o)}},n=function(e,t){var n=function(t){var n=document.getElementById(e),i=n.querySelector("textarea");t?(i.removeAttribute("readonly"),i.style.cursor="auto",i.removeEventListener("click",r),n.querySelector('[data-form-element-type="submit-button"]').style.removeProperty("display")):(i.setAttribute("readonly",!0),i.style.cursor="pointer",i.addEventListener("click",r),n.querySelector('[data-form-element-type="submit-button"]').style.display="none")};null!==t?n(t):clientPackages.get("users").then((function(e){e.currentUser.exists().then((function(e){n(e)}))}))},r=function(e){var n=e.target.closest("form").id;clientPackages.get("users").then((function(e){t(n),e.openLogin()}))},i=function(e){var t=e.target,n=t.previousSibling;t.querySelector('[name="fprcontext"]').value=JSON.stringify({listElementID:n.id})},o=function(e){var t=e.target,n=e.result;void 0!==n.success&&(t.querySelector('[name="fprtext"]').value="",function(e){clientPackages.get("html5DOMDocument").then((function(t){var n=document.getElementById(e.listElementID);t.insert(e.listContent,[n,"outerHTML"])}))}(n))};return{initializeForm:function(e,r){if(n(e,r),r)return t(e)}}}();
 EOT;
